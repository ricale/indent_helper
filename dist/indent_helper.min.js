/*! indent_helper - v0.1.0 - 2015-02-21
* Copyright (c) 2015 ricale; Licensed  */
window.IndentHelper=function(){var a=function(a,b){var c,d="    ",e=function(a){var b=a.value,c=a.selectionStart,d=a.selectionEnd,e=b.substring(c,d);return{element:a,content:b,selectionStart:c,selectionEnd:d,selectionString:e}},f=function(){var a,b=c.content.lastIndexOf("\n",c.selectionStart-1),d=c.content.indexOf("\n",c.selectionEnd);return d=-1==d?c.content.length-1:d,a=c.content.substring(b,d),{start:b,end:d,content:a}},g=function(a,b,d){c.element.value=c.content.substring(0,a)+d+c.content.substring(b,c.content.length)},h=function(a,b,d){c.element.selectionStart=b,c.element.selectionStart<a+1&&(c.element.selectionStart=a+1),d<c.element.selectionStart&&(d=c.element.selectionStart),c.element.selectionEnd=d},i=function(){g(c.selectionStart,c.selectionEnd,d),h(-1,c.selectionStart+d.length,c.selectionStart+d.length)},j=function(){var a,b=f(),d=/(^|\n)([ ]{1,4})/;a=null===b.content.match(d)?0:b.content.match(d)[2].length,g(b.start,b.end,b.content.replace(d,"$1")),h(b.start,c.selectionStart-a,c.selectionStart-a)},k=function(){var a=f(),b=/(^|\n)(?!\n)/g;g(a.start,a.end,a.content.replace(b,"$1"+d)),h(a.start,c.selectionStart+d.length,c.selectionEnd+d.length*c.selectionString.match(b).length)},l=function(){var a,b,d,e=f(),i=/(^|\n)([ ]{1,4})/g,j=e.content.match(i),k=0,l=0;if(null!==j){for(a=c.selectionString.match("\n[ ]{0,3}$"),b=0;b<j.length;b++)d=j[b],k+=b==j.length-1&&a?a[0].length-1:d.match(/[ ]+/)[0].length;null!==c.content.substring(e.start,c.selectionStart).match(i)&&(l=j[0].match(/[ ]+/)[0].length)}g(e.start,e.end,e.content.replace(i,"$1")),h(e.start,c.selectionStart-l,c.selectionEnd-k)};document.selection||(c=e(a),null===c.selectionString.match(/\n/)?b?j():i():b?l():k())};return{indent:a,eventListener:function(b){void 0!==b&&9==b.keyCode&&(b.preventDefault(),a(this,b.shiftKey))},addEventListener:function(a,b){b=b||"keydown",a.addEventListener?a.addEventListener(b,this.eventListener,!1):a.attachEvent?a.attachEvent("on"+b,this.eventListener):a[b]=this.eventListener}}}();